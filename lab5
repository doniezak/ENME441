import time
import RPi.GPIO as gpio
import math


led_pins = [26, 19, 13, 21, 20, 16, 12, 22, 27, 17]
button_pin = 25

gpio.setmode(gpio.BCM)

pwms = []

for p in led_pins:
	gpio.setup(p, gpio.OUT)
	pin = gpio.PWM(p, 500)
	pin.start(0)
	pwms.append(pin)

gpio.setup(button_pin, gpio.IN, pull_up_down=gpio.PUD_DOWN)

direction = 1

def myCallback(button_pin):
	global direction
	direction = -direction

gpio.add_event_detect(button_pin, gpio.RISING, callback=myCallback, bouncetime=100)

try:
	while True:
		t = time.time()
		for i, pwm in enumerate(pwms):
			phi = direction*i*math.pi/11
			b = (math.sin((2*math.pi*0.2*t)-phi))**2
			pwm.ChangeDutyCycle(b*100)

except KeyboardInterrupt: # stop gracefully on ctrl-C
	for pin in pwms:
		pin.stop()
gpio.cleanup()
